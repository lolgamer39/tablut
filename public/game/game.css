/* --- IMPOSTAZIONI GENERALI --- */
body {
    background-color: #faebd7; 
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    width: 100vw;
    height: 100dvh; 
    overflow: hidden; 
    
    /* Layout Flex per centrare tutto */
    display: flex;
    justify-content: center;
    align-items: center;
}

.hidden { display: none !important; }

/* --- LAYOUT CONTAINER (Gestisce PC vs Mobile) --- */
#layout-container {
    display: flex;
    flex-direction: column; /* Mobile: Colonna */
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
}

#main-column {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between; /* Spinge barre agli estremi */
    width: 100%;
    height: 100%;
    padding: 10px 0;
    box-sizing: border-box;
}

/* SIDEBAR (Default: Nascosta su Mobile) */
#sidebar {
    display: none; 
}

/* --- COORDINATE SCACCHIERA (Numeri e Lettere) --- */
.coord {
    position: absolute;
    font-size: 11px;
    font-weight: bold;
    color: rgba(90, 58, 34, 0.7); /* Marrone tenue, semitrasparente */
    font-family: monospace;
    pointer-events: none;
    z-index: 5;
}

/* Numeri (1-9) in alto a sinistra della cella */
.coord-num {
    top: 2px;
    left: 4px;
}

/* Lettere (a-i) in basso a destra della cella */
.coord-letter {
    bottom: 0px;
    right: 3px;
}

/* --- BARRE GIOCATORI --- */
.player-bar {
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    background: white; 
    
    width: 98%; 
    max-width: 800px; 
    padding: 5px 15px;    
    min-height: 45px; 
    
    box-sizing: border-box; 
    border-radius: 8px;   
    border: 3px solid #8b4513; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    
    flex-shrink: 0; 
}

.player-info { display: flex; align-items: center; gap: 10px; overflow: hidden; }

.player-name { 
    font-weight: bold; 
    font-size: clamp(14px, 3vw, 18px); 
    color: #333; 
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis; 
    max-width: 180px; 
}

.color-indicator { 
    width: clamp(20px, 4vw, 26px); 
    height: clamp(20px, 4vw, 26px); 
    flex-shrink: 0; 
    border-radius: 50%; 
    box-shadow: 1px 1px 2px rgba(0,0,0,0.3); 
}
.is-white { background-color: #ffffff; border: 2px solid #333; }
.is-black { background-color: #000000; border: 2px solid #ccc; }

.timer { 
    font-family: 'Courier New', monospace; 
    font-size: clamp(16px, 3.5vw, 22px); 
    font-weight: bold; 
    background-color: #eee; 
    padding: 2px 8px; 
    border-radius: 4px; 
    border: 1px solid #ccc; 
    min-width: 65px; 
    text-align: center; 
}

/* SEGNALE */
.signal-bars { display: flex; align-items: flex-end; gap: 2px; height: 18px; width: 26px; flex-shrink: 0; }
.bar { width: 5px; background-color: #e0e0e0; border-radius: 1px; }
.bar:nth-child(1) { height: 25%; } .bar:nth-child(2) { height: 50%; } .bar:nth-child(3) { height: 75%; } .bar:nth-child(4) { height: 100%; }
.signal-1 .bar:nth-child(1) { background-color: #ff3333; }
.signal-2 .bar:nth-child(1), .signal-2 .bar:nth-child(2) { background-color: #ffcc00; }
.signal-3 .bar:nth-child(1), .signal-3 .bar:nth-child(2), .signal-3 .bar:nth-child(3) { background-color: #99cc33; }
.signal-4 .bar { background-color: #33cc33; }

/* AREA DI GIOCO */
#game-wrapper { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: center; 
    width: 100%; 
    flex-grow: 1; 
    overflow: hidden; 
}
#status-panel { 
    font-size: clamp(16px, 3vw, 20px); 
    color: #5a3a22; 
    margin-bottom: 5px; 
}

/* SCACCHIERA */
#board {
    display: grid; 
    grid-template-columns: repeat(9, 1fr); 
    grid-template-rows: repeat(9, 1fr);
    
    /* Dimensioni Mobile */
    width: min(98vw, 75dvh); 
    height: min(98vw, 75dvh); 
    
    border: 6px solid #5a3a22; 
    background-color: #5a3a22; 
    gap: 2px; 
    box-shadow: 0 5px 25px rgba(0,0,0,0.4);
}

.cell { 
    width: 100%; height: 100%; 
    background-color: #f0e2d0; 
    display: flex; justify-content: center; align-items: center; 
    position: relative; 
    cursor: pointer; 
}
.throne { background-color: #ffd700 !important; }
.escape { background-color: #90ee90 !important; }
.cell:hover { filter: brightness(0.95); }
.selected { background-color: rgba(255, 215, 0, 0.7) !important; }

.hint { 
    width: 30%; height: 30%; 
    background-color: rgba(0, 100, 0, 0.3); 
    border-radius: 50%; 
    pointer-events: none; 
}

/* PEZZI */
.piece { 
    width: 85%; height: 85%; 
    border-radius: 50%; 
    pointer-events: none; 
    z-index: 10; 
    box-shadow: 2px 2px 4px rgba(0,0,0,0.4); 
    position: relative; 
}
.black-piece { background: #111; border: 2px solid #555; }
.white-piece { background: #fff; border: 2px solid #888; }
.king { 
    background: #fff url('../king.png') no-repeat center center; 
    background-size: 75%; 
    border: 3px solid #d4af37; 
    box-shadow: 0 0 5px gold; 
}

/* PULSANTI */
#action-buttons { 
    display: flex; 
    gap: 10px; 
    margin-top: 5px; 
    width: 98%; 
    max-width: 800px; 
}
#action-buttons button { 
    flex: 1; 
    padding: 8px; 
    font-size: 16px; 
    border-radius: 6px; 
    border: none; 
    cursor: pointer; 
    color: white; 
    margin-top: 0; 
}
#undo-btn { background-color: #607d8b; }
#undo-btn:disabled { background-color: #ccc; cursor: not-allowed; }
#surrender-btn { background-color: #d32f2f; }

/* AVVISI */
#connection-warning, #opponent-warning { 
    position: fixed; top: 0; left: 0; width: 100%; 
    padding: 10px; color: white; font-weight: bold; text-align: center; 
    z-index: 20000; 
}
#connection-warning { background-color: #ff9800; } 
#opponent-warning { background-color: #2196f3; }

/* MODALI */
#game-over-modal, #game-cancelled-modal, #undo-request-modal { 
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background-color: rgba(0,0,0,0.85); 
    display: flex; justify-content: center; align-items: center; 
    z-index: 9999; 
}
.modal-content { 
    background: white; padding: 25px; border-radius: 15px; 
    text-align: center; border: 4px solid #8b4513; 
    width: 85%; max-width: 350px; 
}
.modal-content button { 
    background-color: #8b4513; color: white; border: none; 
    padding: 12px 24px; font-size: 18px; border-radius: 8px; cursor: pointer; 
    margin-top: 10px; width: 100%; 
}
.modal-buttons-col { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
.small-modal { max-width: 300px; padding: 20px; }
.row-btns { display: flex; gap: 15px; justify-content: center; margin-top: 15px; }
.row-btns button { width: auto; min-width: 80px; margin: 0; }

/* =========================================
   MEDIA QUERY DESKTOP (Larghezza > 1024px)
   ========================================= */
@media (min-width: 1024px) {
    #layout-container {
        flex-direction: row; /* Affiancati */
        gap: 30px;
        padding: 0 40px;
        box-sizing: border-box;
    }
    
    #main-column {
        width: auto;
        flex-grow: 1;
        /* Limita la larghezza massima della colonna di gioco per non schiacciare la sidebar */
        max-width: 1200px; 
    }

    #sidebar {
        display: flex; /* Mostra sidebar */
        flex-direction: column;
        width: 300px;
        height: 85vh;
        background: white;
        border: 4px solid #8b4513;
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        box-sizing: border-box;
    }
    
    #sidebar h3 { 
        margin-top: 0; 
        color: #8b4513; 
        border-bottom: 2px solid #eee; 
        padding-bottom: 10px; 
    }

    /* Stili per la tabella */
    #move-history-container { 
        flex-grow: 1; 
        overflow-y: auto; 
        border: 1px solid #ccc; 
        margin: 10px 0; 
        background: #f9f9f9;
        border-radius: 6px;
    }
    #move-table { width: 100%; border-collapse: collapse; font-size: 15px; }
    #move-table th { background-color: #8b4513; color: white; padding: 10px; position: sticky; top: 0; }
    #move-table td { padding: 8px; border-bottom: 1px solid #eee; text-align: center; }
    #move-table tr:nth-child(even) { background-color: #fff; }

    #history-controls { display: flex; gap: 10px; justify-content: center; margin-bottom: 5px; }
    .nav-btn { padding: 8px 25px; font-size: 20px; background: #8b4513; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background 0.2s; }
    .nav-btn:hover { background: #a0522d; }
    .nav-btn:disabled { background: #ccc; cursor: default; }
    .small-note { font-size: 13px; color: #777; margin: 5px 0 0 0; }

    /* Ridimensiona leggermente la board su PC per farla stare con la sidebar */
    #board {
        width: min(60vw, 80dvh);
        height: min(60vw, 80dvh);
    }
}
